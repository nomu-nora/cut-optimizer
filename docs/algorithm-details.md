# ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è©³ç´°ä»•æ§˜æ›¸

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: å–ã‚Šæ•°æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ  v1.0
**ä½œæˆæ—¥**: 2025å¹´12æœˆ2æ—¥
**æœ€çµ‚æ›´æ–°**: 2025å¹´12æœˆ2æ—¥

---

## ğŸ“Œ ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€å®Ÿè£…æ™‚ã«åˆ¤æ–­ãŒå¿…è¦ãªç´°ã‹ã„ä»•æ§˜ã‚’è¨˜éŒ²ã—ãŸã‚‚ã®ã§ã™ã€‚
è¦ä»¶å®šç¾©æ›¸ã‚„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸ã§ä¸æ˜ç¢ºã ã£ãŸç‚¹ã‚’ã€Q&Aã‚’é€šã˜ã¦æ˜ç¢ºã«ã—ãŸå†…å®¹ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚

---

## 1. ä½™ç™½ã¨ã‚«ãƒƒãƒˆå¹…ã®æ‰±ã„

### 1.1 ä½™ç™½ã®é©ç”¨ç¯„å›²

**ä»•æ§˜**: å…ƒæ¿ã®**ä¸Šä¸‹å·¦å³ã™ã¹ã¦ã®è¾º**ã«ä½™ç™½ã‚’è¨­ã‘ã‚‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† ä½™ç™½ 20mm                     â”‚
â”‚  â†‘                              â”‚
â”‚  ä½™ç™½ 20mm                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â”‚   æœ‰åŠ¹ã‚¨ãƒªã‚¢             â”‚   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                  ä½™ç™½ 20mm â†“   â”‚
â”‚                     ä½™ç™½ 20mm â†’ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœ‰åŠ¹å¹… = å…ƒæ¿å¹… - (ä½™ç™½ Ã— 2)
æœ‰åŠ¹é«˜ã• = å…ƒæ¿é«˜ã• - (ä½™ç™½ Ã— 2)

ä¾‹: 1820Ã—910mmã®å…ƒæ¿ã§ä½™ç™½20mmã®å ´åˆ
æœ‰åŠ¹ã‚¨ãƒªã‚¢ = 1780Ã—870mm
```

**ç†ç”±**: å®Ÿå®¶ã®æ¥­å‹™ã§ã¯ã€å…ƒæ¿ã®ç«¯ãŒå‚·ã¤ã„ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å…¨è¾ºã«ä¿é™ºã‚¹ãƒšãƒ¼ã‚¹ãŒå¿…è¦ã€‚

---

### 1.2 ã‚«ãƒƒãƒˆå¹…ã®é©ç”¨ç¯„å›²

**ä»•æ§˜**: ã‚«ãƒƒãƒˆå¹…ã¯**è£½å“ã¨è£½å“ã®é–“ã®ã¿**ã«é©ç”¨

```
ä½™ç™½ã§ç«¯ã¯ã‚«ãƒãƒ¼ã•ã‚Œã‚‹ãŸã‚ã€ä»¥ä¸‹ã«ã¯é©ç”¨ã—ãªã„:
- å…ƒæ¿ã®ç«¯ï¼ˆä½™ç™½ã®å†…å´ï¼‰ã¨æœ€åˆã®è£½å“ã®é–“
- æœ€å¾Œã®è£½å“ã®å¾Œã‚ï¼ˆå³å´ãƒ»ä¸‹å´ï¼‰

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ä½™ç™½]                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â†ã‚«ãƒƒãƒˆå¹…â†’ â”Œâ”€â”€â”€â”€â”      â”‚
â”‚  â”‚ A  â”‚    4mm     â”‚ B  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”˜      â”‚
â”‚  â†‘                              â”‚
â”‚  ã‚«ãƒƒãƒˆå¹…ãªã—ï¼ˆä½™ç™½ã§ååˆ†ï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç†ç”±**: ä½™ç™½ãŒæ—¢ã«ç¢ºä¿ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ç«¯ã«è¿½åŠ ã®ã‚«ãƒƒãƒˆå¹…ã¯ä¸è¦ã€‚

---

## 2. è£½å“ã®ã‚½ãƒ¼ãƒˆé †åº

### 2.1 åŸºæœ¬ã‚½ãƒ¼ãƒˆ: é¢ç©ã®å¤§ãã„é †

**ä»•æ§˜**: è£½å“ã‚’é¢ç©é †ï¼ˆå¤§â†’å°ï¼‰ã«ã‚½ãƒ¼ãƒˆ

```typescript
items.sort((a, b) => {
  const areaA = a.width * a.height
  const areaB = b.width * b.height
  return areaB - areaA  // é™é †
})
```

---

### 2.2 åŒã˜é¢ç©ã®å ´åˆ: ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”é †

**ä»•æ§˜**: é¢ç©ãŒåŒã˜è£½å“ã¯ã€**ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ãŒ1:1ã«è¿‘ã„é †**ã«ã‚½ãƒ¼ãƒˆ

```typescript
// ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã®è¨ˆç®—
function getAspectRatio(item: Item): number {
  const ratio = item.width / item.height
  // 1ã«è¿‘ã„ã»ã©æ­£æ–¹å½¢
  return Math.abs(ratio - 1)
}

items.sort((a, b) => {
  const areaA = a.width * a.height
  const areaB = b.width * b.height

  if (areaA === areaB) {
    // é¢ç©ãŒåŒã˜å ´åˆã€ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ãŒ1ã«è¿‘ã„é †
    return getAspectRatio(a) - getAspectRatio(b)
  }

  return areaB - areaA
})
```

**ä¾‹**:
```
è£½å“A: 400Ã—400 (é¢ç© 160,000) â†’ ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯” 1.0
è£½å“B: 500Ã—320 (é¢ç© 160,000) â†’ ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯” 1.56
è£½å“C: 800Ã—200 (é¢ç© 160,000) â†’ ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯” 4.0

ã‚½ãƒ¼ãƒˆçµæœ: A â†’ B â†’ C
```

**ç†ç”±**: æ­£æ–¹å½¢ã«è¿‘ã„è£½å“ã®æ–¹ãŒã€é…ç½®æ™‚ã«æŸ”è»Ÿæ€§ãŒé«˜ãã€ã‚¹ãƒšãƒ¼ã‚¹ã‚’åŠ¹ç‡çš„ã«ä½¿ãˆã‚‹å‚¾å‘ãŒã‚ã‚‹ã€‚

---

## 3. å›è»¢åˆ¤å®šã®ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆé‡è¦ï¼‰

### 3.1 å•é¡Œã®å®šç¾©

è£½å“ã‚’é…ç½®ã™ã‚‹éš›ã€90åº¦å›è»¢ã•ã›ã‚‹ã‹ã©ã†ã‹ã®åˆ¤æ–­ãŒé›£ã—ã„ï¼š

```
å•é¡Œ:
- Bã‚’å›è»¢ãªã—ã§é…ç½®ï¼ˆãã®æ™‚ç‚¹ã§ã¯æ­©ç•™ã¾ã‚Šè‰¯ï¼‰
  â†’ ã§ã‚‚æ¬¡ã®CãŒå…¥ã‚‰ãªã„ â†’ çµæœçš„ã«æ­©ç•™ã¾ã‚Šæ‚ª

- Bã‚’å›è»¢ã‚ã‚Šã§é…ç½®ï¼ˆãã®æ™‚ç‚¹ã§ã¯æ­©ç•™ã¾ã‚Šæ‚ªï¼‰
  â†’ æ¬¡ã®Cã‚‚å…¥ã‚‹ â†’ çµæœçš„ã«æ­©ç•™ã¾ã‚Šè‰¯
```

ã“ã‚Œã¯**ã€Œå±€æ‰€æœ€é© â‰  å…¨ä½“æœ€é©ã€**ã®å…¸å‹çš„ãªå•é¡Œã€‚

---

### 3.2 v1.0ã®è§£æ±ºç­–: æ®‹ã‚¹ãƒšãƒ¼ã‚¹æœ€å¤§åŒ–ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯

**ä»•æ§˜**: å›è»¢ãªã—/ã‚ã‚Šã®ä¸¡æ–¹ã‚’è©¦ã—ã¦ã€**é…ç½®å¾Œã®æœ€å¤§ç©ºãã‚¹ãƒšãƒ¼ã‚¹ãŒå¤§ãããªã‚‹æ–¹**ã‚’é¸ã¶

```typescript
function decideRotation(
  item: Item,
  space: FreeSpace,
  cutConfig: CutConfig
): boolean {

  // 1. å›è»¢ãªã—ã§é…ç½®ã‚’è©¦ã™
  if (canPlace(item, space, cutConfig, false)) {
    const spacesWithoutRotation = simulatePlacement(item, space, cutConfig, false)
    const maxSpaceWithoutRotation = getMaxSpace(spacesWithoutRotation)

    // 2. å›è»¢ã‚ã‚Šã§é…ç½®ã‚’è©¦ã™
    if (canPlace(item, space, cutConfig, true)) {
      const spacesWithRotation = simulatePlacement(item, space, cutConfig, true)
      const maxSpaceWithRotation = getMaxSpace(spacesWithRotation)

      // 3. æœ€å¤§ç©ºãã‚¹ãƒšãƒ¼ã‚¹ãŒå¤§ãã„æ–¹ã‚’é¸ã¶
      if (maxSpaceWithRotation.area > maxSpaceWithoutRotation.area) {
        return true  // å›è»¢ã‚ã‚Š
      }
    }
  }

  return false  // å›è»¢ãªã—ï¼ˆã¾ãŸã¯å›è»¢ã‚ã‚Šã®ã¿å¯èƒ½ãªå ´åˆã¯åˆ¥å‡¦ç†ï¼‰
}

// æœ€å¤§ã®ç©ºãã‚¹ãƒšãƒ¼ã‚¹ã‚’å–å¾—
function getMaxSpace(spaces: FreeSpace[]): FreeSpace {
  return spaces.reduce((max, space) => {
    const area = space.width * space.height
    const maxArea = max.width * max.height
    return area > maxArea ? space : max
  })
}
```

---

### 3.3 åˆ¤å®šãƒ•ãƒ­ãƒ¼

```
è£½å“Bã‚’é…ç½®ã™ã‚‹å ´åˆ:

1. å›è»¢ãªã—ã§é…ç½®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
   â†’ æ®‹ã£ãŸæœ€å¤§ã‚¹ãƒšãƒ¼ã‚¹: 500Ã—300 (150,000mmÂ²)

2. å›è»¢ã‚ã‚Šã§é…ç½®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
   â†’ æ®‹ã£ãŸæœ€å¤§ã‚¹ãƒšãƒ¼ã‚¹: 600Ã—400 (240,000mmÂ²)

3. æ¯”è¼ƒ
   240,000 > 150,000
   â†’ å›è»¢ã‚ã‚Šã‚’æ¡ç”¨

ç†ç”±: æ¬¡ã®è£½å“ãŒå…¥ã‚Šã‚„ã™ããªã‚‹
```

---

### 3.4 ã‚¿ã‚¤ãƒ–ãƒ¬ãƒ¼ã‚¯ï¼ˆåŒã˜å ´åˆï¼‰

æœ€å¤§ã‚¹ãƒšãƒ¼ã‚¹ãŒåŒã˜å ´åˆã¯ã€**å›è»¢ãªã—ã‚’å„ªå…ˆ**ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªæ–¹ã‚’é¸ã¶ï¼‰

```typescript
if (maxSpaceWithRotation.area > maxSpaceWithoutRotation.area) {
  return true  // å›è»¢ã‚ã‚Š
} else {
  return false  // åŒã˜ã¾ãŸã¯å›è»¢ãªã—ãŒè‰¯ã„å ´åˆ
}
```

---

### 3.5 å°†æ¥ã®æ”¹å–„æ¡ˆï¼ˆv2.0ä»¥é™ï¼‰

ã‚ˆã‚Šé«˜åº¦ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å€™è£œï¼š

1. **Look-aheadï¼ˆå…ˆèª­ã¿ï¼‰**: æ¬¡ã®Nå€‹ã®è£½å“ã‚‚è€ƒæ…®ã—ã¦åˆ¤æ–­
2. **Branch and Bound**: è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è©¦ã—ã¦æœ€é©è§£ã‚’æ¢ç´¢
3. **éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: è¤‡æ•°ã®é…ç½®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é€²åŒ–ã•ã›ã‚‹
4. **æ©Ÿæ¢°å­¦ç¿’**: éå»ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æœ€é©ãªåˆ¤æ–­ã‚’å­¦ç¿’

v1.0ã§ã¯è¨ˆç®—é€Ÿåº¦ã¨ã‚·ãƒ³ãƒ—ãƒ«ã•ã‚’å„ªå…ˆã—ã€ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯ã‚’æ¡ç”¨ã€‚

---

## 4. å…ƒæ¿ã‚ˆã‚Šå¤§ãã„è£½å“ã®æ‰±ã„

### 4.1 ç¾çŠ¶ã®æ¥­å‹™ãƒ•ãƒ­ãƒ¼

**å®Ÿå®¶ã®æ¥­å‹™**:
- ãŸã¾ã«å…ƒæ¿ã‚ˆã‚Šå¤§ãã„è£½å“ã®å—æ³¨ãŒã‚ã‚‹
- å…ƒæ¿ã‚µã‚¤ã‚ºã¯ãƒ¡ãƒ¼ã‚«ãƒ¼ã®å›ºå®šã‚µã‚¤ã‚ºã§ã€ãã‚Œã‚ˆã‚Šå¤§ãã„ã‚‚ã®ã¯ç”¨æ„ã•ã‚Œãªã„
- ãã®å ´åˆã€è£½å“ã‚’åˆ†å‰²è£æ–­ã—ã¦è¤‡æ•°ã®å…ƒæ¿ã‹ã‚‰åˆ‡ã‚Šå–ã‚Šã€å¾Œã§ã¤ãªã

---

### 4.2 v1.0ã®å¯¾å¿œæ–¹é‡

**ä»•æ§˜**: è­¦å‘Šã‚’å‡ºã—ã¦ã‚¹ã‚­ãƒƒãƒ—ï¼ˆè¨ˆç®—ã‹ã‚‰é™¤å¤–ï¼‰

```typescript
function validateItems(
  items: Item[],
  plateConfig: PlateConfig,
  cutConfig: CutConfig
): ValidationResult {

  const errors: ValidationError[] = []
  const warnings: ValidationWarning[] = []
  const validItems: Item[] = []
  const skippedItems: Item[] = []

  // æœ‰åŠ¹ã‚¨ãƒªã‚¢ã®è¨ˆç®—
  const effectiveWidth = plateConfig.width - (cutConfig.margin * 2)
  const effectiveHeight = plateConfig.height - (cutConfig.margin * 2)

  for (const item of items) {
    // å…ƒæ¿ã‚ˆã‚Šå¤§ãã„è£½å“ã‚’ãƒã‚§ãƒƒã‚¯
    if (item.width > effectiveWidth || item.height > effectiveHeight) {
      // å›è»¢ã—ã¦ã‚‚å…¥ã‚‰ãªã„å ´åˆ
      if (item.height > effectiveWidth || item.width > effectiveHeight) {
        warnings.push({
          type: 'ITEM_TOO_LARGE',
          itemId: item.id,
          message: `è£½å“ã€Œ${item.name}ã€ã¯å…ƒæ¿ã‚ˆã‚Šå¤§ãã„ãŸã‚è¨ˆç®—ã§ãã¾ã›ã‚“ã€‚ã“ã®è£½å“ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚`
        })
        skippedItems.push(item)
        continue
      }
    }

    validItems.push(item)
  }

  return { validItems, skippedItems, errors, warnings }
}
```

---

### 4.3 UIè¡¨ç¤º

```
è¨ˆç®—å®Ÿè¡Œæ™‚ã«è­¦å‘Šã‚’è¡¨ç¤º:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  è­¦å‘Š                                  â”‚
â”‚                                         â”‚
â”‚ ä»¥ä¸‹ã®è£½å“ã¯å…ƒæ¿ã‚ˆã‚Šå¤§ãã„ãŸã‚          â”‚
â”‚ è¨ˆç®—ã‹ã‚‰é™¤å¤–ã•ã‚Œã¾ã—ãŸ:                 â”‚
â”‚                                         â”‚
â”‚ â€¢ è£½å“X (2000Ã—1000mm)                   â”‚
â”‚ â€¢ è£½å“Y (1900Ã—950mm)                    â”‚
â”‚                                         â”‚
â”‚ ã“ã‚Œã‚‰ã®è£½å“ã‚’å«ã‚ã¦è¨ˆç®—ã™ã‚‹å ´åˆã¯ã€    â”‚
â”‚ å…ƒæ¿ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹ã‹ã€è£½å“ã‚µã‚¤ã‚ºã‚’    â”‚
â”‚ èª¿æ•´ã—ã¦ãã ã•ã„ã€‚                      â”‚
â”‚                                         â”‚
â”‚    [äº†è§£]  [è¨ˆç®—ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è¨ˆç®—çµæœã®ä¸‹éƒ¨ã«è¡¨ç¤º:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¨ˆç®—ã•ã‚Œãªã‹ã£ãŸè£½å“ (2ä»¶)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ è£½å“X (2000Ã—1000mm) - å…ƒæ¿ã‚ˆã‚Šå¤§ãã„  â”‚
â”‚ â€¢ è£½å“Y (1900Ã—950mm) - å…ƒæ¿ã‚ˆã‚Šå¤§ãã„   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4.4 å°†æ¥ã®æ‹¡å¼µï¼ˆv3.0ä»¥é™ï¼‰

**åˆ†å‰²è£æ–­æ©Ÿèƒ½**ã®å®Ÿè£…:

```
æ©Ÿèƒ½:
1. è£½å“ã‚’è¤‡æ•°ã®çŸ©å½¢ã«è‡ªå‹•åˆ†å‰²
2. å„ãƒ‘ãƒ¼ãƒ„ã‚’å…ƒæ¿ã«é…ç½®
3. çµæœã«ã€Œçµ„ã¿ç«‹ã¦æŒ‡ç¤ºã€ã‚’å«ã‚ã‚‹

ä¾‹:
è£½å“X (2000Ã—1000mm) ã‚’åˆ†å‰²
â†’ ãƒ‘ãƒ¼ãƒ„1 (1000Ã—1000mm) + ãƒ‘ãƒ¼ãƒ„2 (1000Ã—1000mm)
â†’ çµåˆç·šã‚’è¡¨ç¤º
```

---

## 5. ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¡¨ç¤ºé †åº

### 5.1 ä»•æ§˜

**ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æšæ•°ãŒå¤šã„é †ã«è¡¨ç¤º**

```typescript
patterns.sort((a, b) => b.count - a.count)

// ãƒ‘ã‚¿ãƒ¼ãƒ³IDã‚’å‰²ã‚Šå½“ã¦
patterns.forEach((pattern, index) => {
  pattern.patternId = String.fromCharCode(65 + index)  // A, B, C...
})
```

---

### 5.2 è¡¨ç¤ºä¾‹

```
è¨ˆç®—çµæœ:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‘ã‚¿ãƒ¼ãƒ³A Ã—8æš    â”‚  â”‚ ãƒ‘ã‚¿ãƒ¼ãƒ³B Ã—5æš    â”‚
â”‚ æ­©ç•™ã¾ã‚Š: 87.5%   â”‚  â”‚ æ­©ç•™ã¾ã‚Š: 85.2%   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‘ã‚¿ãƒ¼ãƒ³C Ã—3æš    â”‚  â”‚ ãƒ‘ã‚¿ãƒ¼ãƒ³D Ã—1æš    â”‚
â”‚ æ­©ç•™ã¾ã‚Š: 90.1%   â”‚  â”‚ æ­©ç•™ã¾ã‚Š: 88.3%   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç†ç”±**:
- ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæšæ•°ãŒå¤šã„ï¼‰ã‚’æœ€åˆã«è¡¨ç¤º
- å®Ÿéš›ã®ä½œæ¥­ã§ã¯ã€å¤§ãã„ã‚‚ã®ã‹ã‚‰åˆ‡ã‚Šå‡ºã™ãŸã‚ã€æšæ•°ãŒå¤šã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…ˆã«ç¢ºèªã—ãŸã„

---

## 6. è‰²ã®å‰²ã‚Šå½“ã¦

### 6.1 ä»•æ§˜

**v1.0ã§ã¯è‡ªå‹•å‰²ã‚Šå½“ã¦ã®ã¿**

- åŒã˜è£½å“åã®å ´åˆã€åŒã˜è‰²ã‚’ä½¿ç”¨
- æ–°ã—ã„è£½å“ã®å ´åˆã€æ—¢ã«ä½¿ã‚ã‚Œã¦ã„ãªã„è‰²ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ
- æ‰‹å‹•å¤‰æ›´æ©Ÿèƒ½ã¯å®Ÿè£…ã—ãªã„ï¼ˆv1.5ä»¥é™ã§æ¤œè¨ï¼‰

```typescript
function assignColor(itemName: string, existingItems: Item[]): string {
  // æ—¢å­˜ã®è£½å“ã¨åŒã˜åå‰ãŒã‚ã‚Œã°ã€åŒã˜è‰²ã‚’ä½¿ã†
  const existingItem = existingItems.find(i => i.name === itemName)
  if (existingItem) {
    return existingItem.color
  }

  // æ–°ã—ã„è£½å“ã®å ´åˆã€æœªä½¿ç”¨ã®è‰²ã‚’é¸ã¶
  const usedColors = new Set(existingItems.map(i => i.color))
  const availableColors = COLOR_PALETTE.filter(c => !usedColors.has(c))

  if (availableColors.length > 0) {
    return availableColors[Math.floor(Math.random() * availableColors.length)]
  }

  // ã™ã¹ã¦ã®è‰²ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ‘ãƒ¬ãƒƒãƒˆã‹ã‚‰é¸ã¶
  return COLOR_PALETTE[Math.floor(Math.random() * COLOR_PALETTE.length)]
}

const COLOR_PALETTE = [
  '#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A',
  '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E2',
  '#F8B739', '#52B788', '#E76F51', '#2A9D8F'
]
```

---

## 7. æƒ³å®šè¦æ¨¡ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### 7.1 å®Ÿå®¶ã®æ¥­å‹™è¦æ¨¡

**æƒ³å®šå…¥åŠ›**:
- è£½å“ç¨®é¡: ç´„10ç¨®é¡
- ç·å€‹æ•°: 30ã€œ50å€‹
- å…ƒæ¿ã‚µã‚¤ã‚º: 1820Ã—910mmï¼ˆã‚µãƒ–ãƒ­ã‚¯æ¿ï¼‰
- è¨ˆç®—é »åº¦: 1æ—¥2å›ç¨‹åº¦

---

### 7.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

| é …ç›® | ç›®æ¨™ |
|------|------|
| è¨ˆç®—æ™‚é–“ | 3ç§’ä»¥å†… |
| UIå¿œç­”æ€§ | å³åº§ï¼ˆ<100msï¼‰ |
| æç”»é€Ÿåº¦ | 1ç§’ä»¥å†… |

---

### 7.3 ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

v1.0ã§ã®ä¸Šé™ï¼ˆç›®å®‰ï¼‰:
- è£½å“ç¨®é¡: 20ç¨®é¡ã¾ã§
- ç·å€‹æ•°: 100å€‹ã¾ã§
- å…ƒæ¿æšæ•°: 30æšã¾ã§

ã“ã‚Œã‚’è¶…ãˆã‚‹å ´åˆã¯ã€v2.0ã§ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æœ€é©åŒ–ã‚’æ¤œè¨ã€‚

---

## 8. ãƒ†ã‚¹ãƒˆç”¨ãƒ—ãƒªã‚»ãƒƒãƒˆ

### 8.1 ä»•æ§˜

**1ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ±ç”¨çš„ãªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”¨æ„**

```json
{
  "plateConfig": {
    "width": 1820,
    "height": 910,
    "unitPrice": 2000
  },
  "cutConfig": {
    "cutWidth": 4,
    "margin": 20
  },
  "items": [
    {
      "id": "preset-1",
      "name": "å¤§å‹ãƒ‘ãƒãƒ«",
      "width": 600,
      "height": 400,
      "quantity": 5,
      "color": "#FF6B6B"
    },
    {
      "id": "preset-2",
      "name": "ä¸­å‹ãƒ‘ãƒãƒ«",
      "width": 400,
      "height": 300,
      "quantity": 8,
      "color": "#4ECDC4"
    },
    {
      "id": "preset-3",
      "name": "å°å‹ãƒ‘ãƒãƒ«",
      "width": 200,
      "height": 150,
      "quantity": 12,
      "color": "#45B7D1"
    }
  ]
}
```

**é…ç½®å ´æ‰€**: `public/presets/test-data.json` ã¾ãŸã¯ `src/lib/presets.ts`

---

### 8.2 ãƒ—ãƒªã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿

```typescript
// UIã«ã€Œãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã€ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
function loadPreset() {
  const preset = TEST_PRESET
  setPlateConfig(preset.plateConfig)
  setCutConfig(preset.cutConfig)
  setItems(preset.items)
}
```

v1.0ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«ãƒ†ã‚¹ãƒˆã—ã¦ã€å•é¡Œãªã‘ã‚Œã°ãƒ—ãƒªã‚»ãƒƒãƒˆã‚’å‰Šé™¤ã¾ãŸã¯éè¡¨ç¤ºåŒ–ã€‚

---

## 9. å°åˆ·ç‰©ã«å«ã‚ã‚‹æƒ…å ±

### 9.1 å¿…é ˆæƒ…å ±

**v1.0ã§å°åˆ·ç‰©ã«å«ã‚ã‚‹æƒ…å ±**:

1. **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å›³** (æœ€é‡è¦)
   - å…ƒæ¿ã®é…ç½®å›³ï¼ˆè‰²åˆ†ã‘ã€è£½å“åè¡¨ç¤ºï¼‰

2. **å„å…ƒæ¿ã®è£½å“æ•°**
   - 1æšã®å…ƒæ¿ã‹ã‚‰å„è£½å“ãŒä½•å€‹åˆ‡ã‚Šå‡ºã›ã¦ã„ã‚‹ã‹
   - ä¾‹: ã‚¢ã‚¤ãƒ†ãƒ AÃ—3, ã‚¢ã‚¤ãƒ†ãƒ BÃ—2

3. **åˆè¨ˆè£½å“æ•°**
   - ã™ã¹ã¦ã®å…ƒæ¿ã‹ã‚‰åˆè¨ˆã§ä½•å€‹åˆ‡ã‚Šå‡ºã›ã¦ã„ã‚‹ã‹
   - ä¾‹: ã‚¢ã‚¤ãƒ†ãƒ A åˆè¨ˆ15å€‹ï¼ˆè¦æ±‚15å€‹ï¼‰

4. **å…ƒæ¿ã®å¿…è¦æšæ•°**
   - ä¾‹: åˆè¨ˆ12æšå¿…è¦

5. **æ­©ç•™ã¾ã‚Šç‡**
   - å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ­©ç•™ã¾ã‚Šç‡
   - å…¨ä½“ã®å¹³å‡æ­©ç•™ã¾ã‚Šç‡

---

### 9.2 å°†æ¥è¿½åŠ ã™ã‚‹æƒ…å ±ï¼ˆv1.5ä»¥é™ï¼‰

- è¨ˆç®—æ—¥æ™‚
- ä½œæ¥­è€…å
- æ³¨æ–‡ç•ªå·
- å‚™è€ƒæ¬„

---

## 10. ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 10.1 è£½å“ãŒ1ã¤ã‚‚é…ç½®ã§ããªã„å ´åˆ

```typescript
// ã™ã¹ã¦ã®è£½å“ãŒé…ç½®ã§ããªã‹ã£ãŸå ´åˆ
if (plates.length === 0 || plates.every(p => p.placements.length === 0)) {
  throw new Error(
    'è£½å“ã‚’é…ç½®ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚å…ƒæ¿ã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹ã‹ã€è£½å“ã‚µã‚¤ã‚ºã‚’å°ã•ãã—ã¦ãã ã•ã„ã€‚'
  )
}
```

---

### 10.2 è£½å“æ•°ãŒä¸€è‡´ã—ãªã„å ´åˆ

è¨ˆç®—å¾Œã€è¦æ±‚å€‹æ•°ã¨é…ç½®å€‹æ•°ã‚’æ¤œè¨¼:

```typescript
function validateResult(items: Item[], result: CalculationResult): void {
  const placedCounts = new Map<string, number>()

  // é…ç½®ã•ã‚ŒãŸå€‹æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
  result.patterns.forEach(pattern => {
    pattern.placements.forEach(placement => {
      const count = placedCounts.get(placement.item.id) || 0
      placedCounts.set(placement.item.id, count + 1)
    })
  })

  // è¦æ±‚å€‹æ•°ã¨æ¯”è¼ƒ
  items.forEach(item => {
    const placedCount = (placedCounts.get(item.id) || 0) * pattern.count
    if (placedCount < item.quantity) {
      console.warn(
        `è£½å“ã€Œ${item.name}ã€ã®é…ç½®å€‹æ•°ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚` +
        `è¦æ±‚: ${item.quantity}å€‹, é…ç½®: ${placedCount}å€‹`
      )
    }
  })
}
```

---

## 11. æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | æ›´æ–°å†…å®¹ |
|------|---------|
| 2025-12-02 | åˆç‰ˆä½œæˆã€‚Q&Aã§æ˜ç¢ºã«ãªã£ãŸä»•æ§˜ã‚’ã™ã¹ã¦è¨˜éŒ² |

---

## 12. å‚è€ƒè³‡æ–™

- [è¦ä»¶å®šç¾©æ›¸](./torikazu_app_requirements_v1.0.md)
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸](./architecture.md)
- [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆæ›¸](./data-flow.md)

---

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å®Ÿè£…æ™‚ã®åˆ¤æ–­åŸºæº–ã¨ã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚**
**ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã—ã¦è¨˜éŒ²ã‚’æ®‹ã—ã¦ãã ã•ã„ã€‚**
